<?php

function randIP(){
       $ip_long = array(
           array('607649792', '608174079'), //36.56.0.0-36.63.255.255
           array('1038614528', '1039007743'), //61.232.0.0-61.237.255.255
           array('1783627776', '1784676351'), //106.80.0.0-106.95.255.255
           array('2035023872', '2035154943'), //121.76.0.0-121.77.255.255
           array('2078801920', '2079064063'), //123.232.0.0-123.235.255.255
           array('-1950089216', '-1948778497'), //139.196.0.0-139.215.255.255
           array('-1425539072', '-1425014785'), //171.8.0.0-171.15.255.255
           array('-1236271104', '-1235419137'), //182.80.0.0-182.92.255.255
           array('-770113536', '-768606209'), //210.25.0.0-210.47.255.255
           array('-569376768', '-564133889'), //222.16.0.0-222.95.255.255
       );
       $rand_key = mt_rand(0, 9);
       $ip= long2ip(mt_rand($ip_long[$rand_key][0], $ip_long[$rand_key][1]));
       $headers['CLIENT-IP'] = $ip;
       $headers['X-FORWARDED-FOR'] = $ip;

       $headerArr = array();
       foreach( $headers as $n => $v ) {
           $headerArr[] = $n .':' . $v;
       }
       return $headerArr;
   }
   
function curl_string ($url){

$proxy_list = array("47.104.155.76:1080","101.132.152.144:80","47.74.134.234:80","47.88.175.178:1080","120.26.51.101:8118","47.89.249.110:8118","47.94.107.71:8080","47.52.24.132:8118","139.196.17.196:8118","47.88.156.143:8118","47.94.230.42:9999","120.76.77.152:9999","47.88.32.46:3128","47.89.41.164:80","59.110.221.78:80","182.92.242.11:80","119.23.63.152:8118","47.90.2.253:8118","47.89.249.110:80","106.14.209.135:80","114.215.174.227:8080","47.89.241.103:8080","47.52.142.42:8118","47.52.62.110:8080","120.79.162.100:1080","39.108.171.142:80","121.196.226.246:84","118.178.227.171:80","115.29.170.58:8118","47.52.41.254:8118","120.76.79.21:80","39.106.97.102:8080","101.132.146.103:8080","120.25.253.234:8118","120.27.220.218:80","120.55.61.182:80","121.41.175.199:80","114.215.102.168:8081","39.106.19.230:3389","120.27.49.85:8090","47.90.87.225:88","101.201.79.172:808","120.77.201.46:8080","106.14.51.145:8118","47.52.231.140:8080","47.52.29.64:80","120.25.164.134:8118","47.96.250.208:3128","47.52.61.212:8080","101.200.89.170:8888","101.132.148.7:8080","47.88.20.189:80","115.28.229.65:80","47.93.3.242:80","47.52.98.198:8118","47.90.62.177:8080","120.27.10.38:8090","47.88.156.143:80","47.52.3.230:443","106.14.12.240:8082","120.27.195.59:9999","47.52.112.218:3128","47.88.226.56:80","47.52.58.163:80","121.40.108.76:80","47.52.41.254:80","121.40.164.232:8118","106.14.165.136:8118","47.90.62.177:8080","47.52.61.212:8080","47.52.231.140:8080","47.90.87.225:88","150.95.190.102:80","45.32.52.17:3128","118.193.107.174:80","118.193.107.190:80","118.193.107.99:80","106.39.179.248:80","118.193.107.36:80","118.193.107.207:80"); 


  $proxy ="118.193.107.207:80";
$ch = curl_init();
$headers = randIp();
$useragent = array(
            'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0)',
            'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)',
            'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)',
            'Mozilla/5.0 (Windows; U; Windows NT 5.2) Gecko/2008070208 Firefox/3.0.1',
            'Opera/9.27 (Windows NT 5.2; U; zh-cn)',
            'Opera/8.0 (Macintosh; PPC Mac OS X; U; en)',
            'Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML, like Gecko) Chrome/0.2.149.27 Safari/525.13 ',
            'Mozilla/5.0 (Windows; U; Windows NT 5.2) AppleWebKit/525.13 (KHTML, like Gecko) Version/3.1 Safari/525.13'

        );
//curl_setopt ($ch, CURLOPT_PROXY, $proxy);
$proxy =array_rand($proxy_list);

$proxy = $proxy_list[$proxy];

 $proxy ="122.183.139.107:8080";
 

curl_setopt ($ch, CURLOPT_PROXY, $proxy);
curl_setopt ($ch, CURLOPT_URL, $url);
curl_setopt ($ch, CURLOPT_USERAGENT, "Mozilla/4.0");
//curl_setopt ($ch, CURLOPT_COOKIEJAR, "d:\cookies.txt");
curl_setopt ($ch, CURLOPT_HEADER, 1);
curl_setopt ($ch, CURLOPT_HTTPHEADER, $headers);  //此处可以改为任意假IP
curl_setopt ($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt ($ch, CURLOPT_FOLLOWLOCATION, 1);
curl_setopt ($ch, CURLOPT_TIMEOUT, 120);

$result = curl_exec ($ch);
curl_close($ch);
return $result;
}



      $url = "http://www.dicts.cn/dict/dict/dict!searchhtml3.asp?id=test";
    //  $tmp_url = curl_get_file_contents($url);


    //  $url_page = "http://sample.app/test.php";
$proxy = "209.88.95.2186:80";    //此处为代理服务器IP和PORT

$tmp_url = curl_string($url);

var_dump($tmp_url);
?> 